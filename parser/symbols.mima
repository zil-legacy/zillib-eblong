
<DEFINITIONS "SYMBOLS">

<USE "NEWSTRUC">

<INCLUDE "SET">

<BLOCK (<ROOT>)>

GET-CLASSIFICATION

NUMBER-WORD-CLASSES

<ENDBLOCK>

<SET-DEFSTRUCT-FILE-DEFAULTS>

<DEFSTRUCT SYMBOL (VECTOR ('PRINTTYPE PRINT-SYMBOL)) (SYM-NAME ATOM 'NONE) (SYM-NUMBER <OR FALSE FIX> <>) (SYM-PRODS LIST ()) (SYM-FIRSTS SET <MAKE-SET>) (SYM-WEIGHT FIX '1)>

#WORD *4344620046*
		    <GFCN PRINT-SYMBOL ("VALUE" ATOM SYMBOL) SYM4>
		    <TEMP TEMP6>
		    <INTGO>
		    <FRAME 'PRIN1>
		    <NTHUV SYM4 1 = STACK (TYPE ATOM)>
		    <DEAD SYM4>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRIN1 2 = TEMP6>
		    <RETURN TEMP6>
		    <DEAD TEMP6>
		    <END PRINT-SYMBOL>

<GDECL (NUM-OF-TERMINALS NUM-OF-SYMBOLS NUM-OF-NONTERMINALS) FIX (ALL-SYMBOLS) <LIST [REST SYMBOL]> (EPSILON-SYMBOL START-SYMBOL END-OF-INPUT-SYMBOL) SYMBOL (SYMBOL-VECTOR) <VECTOR [2 VECTOR]>>

<GDECL (ALL-TERMINALS ALL-NONTERMINALS) <LIST [REST SYMBOL]>>

<COND (<NOT <GASSIGNED? ALL-SYMBOLS>> <SETG ALL-SYMBOLS ()>)>

#WORD *35067407355*
		    <GFCN RESET-SYMBOLS ("VALUE" SYMBOL "OPTIONAL" ANY) TERMINALS?6>
		    <OPT-DISPATCH 0 %<> OPT4 OPT5>
OPT4
		    <PUSH %<>>
OPT5
		    <TEMP TEMP18:LIST SYM19 TEMP26:LIST TEMP27>
		    <INTGO>
		    <GVAL 'ALL-SYMBOLS = TEMP18 (TYPE LIST)>
		    <LOOP>
MAP8
		    <INTGO>
		    <EMPL? TEMP18 + MAPAP11 (DEAD-JUMP TEMP18)>
		    <NTHL TEMP18 1 = SYM19>
		    <TYPE? TERMINALS?6 <TYPE-CODE FALSE> - TAG23>
		    <GVAL 'ALL-TERMINALS = TEMP26 (TYPE LIST)>
		    <EMPL? TEMP26 + TAG23 (DEAD-JUMP TEMP26)>
		    <LOOP (SYM19 VALUE) (TEMP26 VALUE)>
TAG24
		    <NTHL TEMP26 1 = TEMP27>
		    <VEQUAL? TEMP27 SYM19 + PHRASE21 (DEAD-JUMP TEMP26 SYM19)>
		    <DEAD TEMP27>
		    <RESTL TEMP26 1 = TEMP26 (TYPE LIST)>
		    <EMPL? TEMP26 - TAG24 (DEAD-FALL TEMP26)>
TAG23
		    <FRAME 'PUTPROP>
		    <NTHUV SYM19 1 = STACK (TYPE ATOM)>
		    <DEAD SYM19>
		    <PUSH 'SYMBOL>
		    <CALL 'PUTPROP 2>
PHRASE21
		    <RESTL TEMP18 1 = TEMP18 (TYPE LIST)>
		    <JUMP + MAP8>
MAPAP11
		    <TYPE? TERMINALS?6 <TYPE-CODE FALSE> + PHRASE30>
		    <SETG 'ALL-TERMINALS ()>
PHRASE30
		    <SETG 'ALL-NONTERMINALS ()>
		    <SET SYM19 0 (TYPE FIX)>
		    <GVAL 'ALL-TERMINALS = TEMP18 (TYPE LIST)>
		    <LOOP (TEMP18 VALUE) (SYM19 VALUE)>
TAG32
		    <INTGO>
		    <EMPL? TEMP18 + TAG31 (DEAD-JUMP TEMP18)>
		    <NTHL TEMP18 1 = STACK>
		    <RESTL TEMP18 1 = TEMP18 (TYPE LIST)>
		    <ADD SYM19 1 = SYM19 (TYPE FIX)>
		    <JUMP + TAG32>
TAG31
		    <LIST SYM19 = TEMP18 (TYPE LIST)>
		    <DEAD SYM19>
		    <SETG 'ALL-SYMBOLS TEMP18>
		    <DEAD TEMP18>
		    <SETG 'ALL-PRODUCTIONS ()>
		    <TYPE? TERMINALS?6 <TYPE-CODE FALSE> + PHRASE35>
		    <DEAD TERMINALS?6>
		    <SETG 'NUM-OF-TERMINALS 0>
PHRASE35
		    <SETG 'NUM-OF-NONTERMINALS 0>
		    <GVAL 'NUM-OF-TERMINALS = SYM19 (TYPE FIX)>
		    <SETG 'NUM-OF-SYMBOLS SYM19>
		    <DEAD SYM19>
		    <SETG 'NUM-OF-PRODUCTIONS 0>
		    <FRAME 'MAKE-INTERNAL>
		    <PUSH 'EPSILON>
		    <CALL 'MAKE-INTERNAL 1 = SYM19>
		    <SETG 'EPSILON-SYMBOL SYM19>
		    <DEAD SYM19>
		    <FRAME 'MAKE-INTERNAL>
		    <PUSH 'START>
		    <CALL 'MAKE-INTERNAL 1 = SYM19>
		    <SETG 'START-SYMBOL SYM19>
		    <RETURN SYM19>
		    <DEAD SYM19>
		    <END RESET-SYMBOLS>

#WORD *24046066076*
		    <GFCN TERMINALS ("VALUE" SYMBOL "TUPLE" <TUPLE [REST <OR ATOM <LIST ATOM FIX>>]>)>
		    <MAKTUP ATMS4 T5 = ATMS4>
		    <INTGO>
		    <LENUV ATMS4 = T5 (TYPE FIX)>
		    <GRTR? T5 14 - PHRASE7 (TYPE FIX)>
		    <DEAD T5>
		    <FRAME 'PRINT-MANY>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <PUSH 'PRINC>
		    <LENUV ATMS4 = STACK (TYPE FIX)>
		    <PUSH " terminals defined.">
		    <PUSH 'PRMANY-CRLF>
		    <CALL 'PRINT-MANY 5>
PHRASE7
		    <LENUV ATMS4 = T5 (TYPE FIX)>
		    <ADD T5 1 = T5 (TYPE FIX)>
		    <SETG 'NUMBER-WORD-CLASSES T5>
		    <DEAD T5>
		    <FRAME 'RESET-SYMBOLS>
		    <PUSH 'T>
		    <CALL 'RESET-SYMBOLS 1>
		    <CHTYPE ATMS4 <TYPE-CODE VECTOR> = T5>
		    <DEAD ATMS4>
		    <LOOP>
MAP15
		    <INTGO>
		    <EMPUV? T5 + MAP14 (DEAD-JUMP T5)>
		    <FRAME 'MAKE-TERMINAL>
		    <NTHUV T5 1 = STACK>
		    <CALL 'MAKE-TERMINAL 1>
		    <RESTUV T5 1 = T5 (TYPE VECTOR)>
		    <JUMP + MAP15>
MAP14
		    <FRAME 'MAKE-TERMINAL>
		    <PUSH 'END-OF-INPUT>
		    <CALL 'MAKE-TERMINAL 1 = ATMS4>
		    <SETG 'END-OF-INPUT-SYMBOL ATMS4>
		    <RETURN ATMS4>
		    <DEAD ATMS4>
		    <END TERMINALS>

#WORD *16420300312*
		    <GFCN MAKE-INTERNAL ("VALUE" SYMBOL ATOM) ATM4>
		    <TEMP TEMP11>
		    <INTGO>
		    <PUSH ATM4>
		    <PUSH %<>>
		    <PUSH ()>
		    <FRAME 'MAKE-SET>
		    <CALL 'MAKE-SET 0 = STACK>
		    <PUSH 1>
		    <UBLOCK <TYPE-CODE VECTOR> 5 = TEMP11 (TYPE VECTOR)>
		    <CHTYPE TEMP11 <TYPE-CODE SYMBOL> = TEMP11>
		    <FRAME 'PUTPROP>
		    <PUSH ATM4>
		    <DEAD ATM4>
		    <PUSH 'SYMBOL>
		    <PUSH TEMP11>
		    <CALL 'PUTPROP 3>
		    <RETURN TEMP11>
		    <DEAD TEMP11>
		    <END MAKE-INTERNAL>

<SETG SYMBOL-OBS <MOBLIST SYMBOLS>>

#WORD *15755705253*
		    <GFCN GET-CLASSIFICATION-NUMBER ("VALUE" <OR FORM GVAL> "QUOTE" ANY) ATM4>
		    <TEMP TEMP10>
		    <INTGO>
		    <TYPE? ATM4 <TYPE-CODE ATOM> - PHRASE6>
		    <NTHR ATM4 3 = ATM4 (RECORD-TYPE ATOM)>
PHRASE6
		    <TYPE? ATM4 <TYPE-CODE STRING> - PHRASE8>
		    <FRAME 'LOOKUP>
		    <PUSH ATM4>
		    <GVAL 'SYMBOL-OBS = STACK (TYPE OBLIST)>
		    <CALL 'LOOKUP 2 = TEMP10>
		    <TYPE? TEMP10 <TYPE-CODE FALSE> - BOOL9 (DEAD-JUMP ATM4) (DEAD-FALL TEMP10)>
		    <FRAME 'INSERT>
		    <PUSH ATM4>
		    <DEAD ATM4>
		    <GVAL 'SYMBOL-OBS = STACK (TYPE OBLIST)>
		    <CALL 'INSERT 2 = TEMP10>
BOOL9
		    <CHTYPE TEMP10 <TYPE-CODE GVAL> = TEMP10>
		    <RETURN TEMP10>
		    <DEAD TEMP10>
PHRASE8
		    <FRAME 'FORM>
		    <PUSH 'GET-CLASSIFICATION>
		    <PUSH ATM4>
		    <DEAD ATM4>
		    <CALL 'FORM 2 = TEMP10>
		    <RETURN TEMP10>
		    <DEAD TEMP10>
		    <END GET-CLASSIFICATION-NUMBER>
<COND (<AND <GASSIGNED? GET-CLASSIFICATION-NUMBER> <NOT <TYPE? ,GET-CLASSIFICATION-NUMBER MACRO>>> <SETG GET-CLASSIFICATION-NUMBER <CHTYPE (,GET-CLASSIFICATION-NUMBER) MACRO>>)>

#WORD *14122472555*
		    <GFCN BUILD-SYMBOL ("VALUE" SYMBOL ATOM FIX) ATM4 ID5>
		    <TEMP NAM6 SYM10:SYMBOL TEMP15>
		    <INTGO>
		    <NTHR ATM4 3 = NAM6 (RECORD-TYPE ATOM)>
		    <FRAME 'MAKE-INTERNAL>
		    <PUSH ATM4>
		    <CALL 'MAKE-INTERNAL 1 = SYM10>
		    <FRAME 'PUTPROP>
		    <PUSH ATM4>
		    <DEAD ATM4>
		    <PUSH 'SYMBOL>
		    <PUSH SYM10>
		    <CALL 'PUTPROP 3>
		    <PUTUV SYM10 2 ID5>
		    <FRAME 'LOOKUP>
		    <PUSH NAM6>
		    <GVAL 'SYMBOL-OBS = STACK (TYPE OBLIST)>
		    <CALL 'LOOKUP 2 = TEMP15>
		    <TYPE? TEMP15 <TYPE-CODE FALSE> - BOOL14 (DEAD-JUMP NAM6) (DEAD-FALL TEMP15)>
		    <FRAME 'INSERT>
		    <PUSH NAM6>
		    <DEAD NAM6>
		    <GVAL 'SYMBOL-OBS = STACK (TYPE OBLIST)>
		    <CALL 'INSERT 2 = TEMP15>
BOOL14
		    <NTHR TEMP15 1 = NAM6 (RECORD-TYPE ATOM) (BRANCH-FALSE + TAG19) (DEAD-JUMP NAM6)>
		    <TYPE? NAM6 <TYPE-CODE FALSE> + TAG19 (DEAD-JUMP NAM6) (DEAD-FALL TEMP15)>
		    <PUTR NAM6 1 ID5 (RECORD-TYPE GBIND)>
		    <DEAD NAM6 ID5>
		    <JUMP + TAG20>
TAG19
		    <FRAME 'SETG>
		    <PUSH TEMP15>
		    <DEAD TEMP15>
		    <PUSH ID5>
		    <DEAD ID5>
		    <CALL 'SETG 2>
TAG20
		    <GVAL 'ALL-SYMBOLS = TEMP15 (TYPE LIST)>
		    <CONS SYM10 TEMP15 = TEMP15>
		    <SETG 'ALL-SYMBOLS TEMP15>
		    <DEAD TEMP15>
		    <RETURN SYM10>
		    <DEAD SYM10>
		    <END BUILD-SYMBOL>

<MSETG MAX-TERMINALS 30>

#WORD *15550024256*
		    <GFCN MAKE-TERMINAL ("VALUE" SYMBOL <OR ATOM <LIST ATOM FIX>>) FROB4>
		    <TEMP (WEIGHT6:FIX 1) TEMP11 TEMP16>
		    <INTGO>
		    <GVAL 'NUM-OF-TERMINALS = TEMP11 (TYPE FIX)>
		    <ADD TEMP11 1 = TEMP11 (TYPE FIX)>
		    <SETG 'NUM-OF-TERMINALS TEMP11>
		    <GRTR? TEMP11 30 - PHRASE10 (TYPE FIX) (DEAD-FALL WEIGHT6)>
		    <DEAD TEMP11>
		    <FRAME 'ERROR>
		    <PUSH 'TOO-MANY-TERMINALS!-ERRORS>
		    <PUSH FROB4>
		    <DEAD FROB4>
		    <PUSH 'MAKE-TERMINAL>
		    <CALL 'ERROR 3 = TEMP11>
		    <RETURN TEMP11>
		    <DEAD TEMP11>
PHRASE10
		    <TYPE? FROB4 <TYPE-CODE LIST> - PHRASE15 (DEAD-FALL WEIGHT6)>
		    <NTHL FROB4 1 = TEMP11 (TYPE ATOM)>
		    <RESTL FROB4 1 = TEMP16 (TYPE LIST)>
		    <DEAD FROB4>
		    <NTHL TEMP16 1 = WEIGHT6 (TYPE FIX)>
		    <DEAD TEMP16>
		    <JUMP + PHRASE17>
PHRASE15
		    <SET TEMP11 FROB4>
		    <DEAD FROB4>
PHRASE17
		    <GVAL 'NUM-OF-TERMINALS = TEMP16 (TYPE FIX)>
		    <GRTR? TEMP16 15 - PHRASE19 (TYPE FIX)>
		    <SUB TEMP16 16 = TEMP16 (TYPE FIX)>
		    <LSH 1 TEMP16 = TEMP16 (TYPE FIX)>
		    <OR TEMP16 #WORD *100000* = TEMP16>
		    <JUMP + PHRASE20>
PHRASE19
		    <SUB TEMP16 1 = TEMP16 (TYPE FIX)>
		    <LSH 1 TEMP16 = TEMP16 (TYPE FIX)>
PHRASE20
		    <FRAME 'BUILD-SYMBOL>
		    <PUSH TEMP11>
		    <DEAD TEMP11>
		    <PUSH TEMP16>
		    <DEAD TEMP16>
		    <CALL 'BUILD-SYMBOL 2 = TEMP11>
		    <PUTUV TEMP11 5 WEIGHT6 (TYPE FIX)>
		    <DEAD WEIGHT6>
		    <GVAL 'ALL-TERMINALS = TEMP16 (TYPE LIST)>
		    <CONS TEMP11 TEMP16 = TEMP16>
		    <SETG 'ALL-TERMINALS TEMP16>
		    <DEAD TEMP16>
		    <RETURN TEMP11>
		    <DEAD TEMP11>
		    <END MAKE-TERMINAL>

#WORD *17023735303*
		    <GFCN MAKE-NONTERMINAL ("VALUE" SYMBOL ATOM) ATM4>
		    <TEMP TEMP7 NONTERM5:SYMBOL>
		    <INTGO>
		    <FRAME 'BUILD-SYMBOL>
		    <PUSH ATM4>
		    <DEAD ATM4>
		    <GVAL 'NUM-OF-NONTERMINALS = TEMP7 (TYPE FIX)>
		    <ADD TEMP7 1 = TEMP7 (TYPE FIX)>
		    <SETG 'NUM-OF-NONTERMINALS TEMP7>
		    <SUB 0 TEMP7 = STACK (TYPE FIX)>
		    <DEAD TEMP7>
		    <CALL 'BUILD-SYMBOL 2 = NONTERM5>
		    <GVAL 'ALL-NONTERMINALS = TEMP7 (TYPE LIST)>
		    <CONS NONTERM5 TEMP7 = TEMP7>
		    <SETG 'ALL-NONTERMINALS TEMP7>
		    <DEAD TEMP7>
		    <RETURN NONTERM5>
		    <DEAD NONTERM5>
		    <END MAKE-NONTERMINAL>

#WORD *5164263404*
		    <GFCN LOOKUP-SYMBOL ("VALUE" SYMBOL ATOM) ATM4>
		    <TEMP TEMP6>
		    <INTGO>
		    <FRAME 'GETPROP>
		    <PUSH ATM4>
		    <PUSH 'SYMBOL>
		    <CALL 'GETPROP 2 = TEMP6>
		    <TYPE? TEMP6 <TYPE-CODE FALSE> - BOOL5 (DEAD-JUMP ATM4) (DEAD-FALL TEMP6)>
		    <FRAME 'MAKE-NONTERMINAL>
		    <PUSH ATM4>
		    <DEAD ATM4>
		    <CALL 'MAKE-NONTERMINAL 1 = TEMP6>
BOOL5
		    <RETURN TEMP6>
		    <DEAD TEMP6>
		    <END LOOKUP-SYMBOL>

<END-DEFINITIONS>
